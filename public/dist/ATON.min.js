parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"XTSP":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=c();return function(){var i,n=l(t);if(e){var r=l(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return a(this,i)}}function a(e,i){return!i||"object"!==t(i)&&"function"!=typeof i?u(e):i}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var v=function(t){r(o,THREE.Group);var i=s(o);function o(t,n){var r;return e(this,o),h(u(r=i.call(this)),"updateLightProbes",function(){return r.traverse(function(t){if(t.isMesh&&t.geometry){var e=t.userData.LP;void 0!==e&&(e.update(),t.material.envMap=e.getEnvTex())}}),u(r)}),r.type=n||ATON.NTYPES.SCENE,r.bPickable=!0,r.type===ATON.NTYPES.SCENE&&(r._rootG=ATON._rootVisible,r._nodes=ATON.snodes),r.type===ATON.NTYPES.SEM&&(r._rootG=ATON._rootSem,r._nodes=ATON.semnodes),r.type===ATON.NTYPES.UI&&(r._rootG=ATON._rootUI,r._nodes=ATON.uinodes),r.as(t),r.kwords=void 0,r._bCloneOnLoadHit=!0,r.onHover=void 0,r.onLeave=void 0,r.onSelect=void 0,r}return n(o,[{key:"as",value:function(t){if(void 0!==t&&t!==ATON.ROOT_NID)return this._nodes[t]=this,this.nid=t,this.name=t,this}},{key:"setAsRoot",value:function(){return this._nodes[ATON.ROOT_NID]=this,this.nid=ATON.ROOT_NID,this}},{key:"setCloneOnLoadHit",value:function(t){return this._bCloneOnLoadHit=t,this}},{key:"addKeyword",value:function(t){return void 0===this.kwords&&(this.kwords=[]),this.kwords.push(t),this}},{key:"hide",value:function(){var t=this;this.visible=!1,this.traverse(function(e){e.layers.disable(t.type)})}},{key:"show",value:function(){var t=this;return this.visible=!0,this.bPickable&&this.traverse(function(e){e.layers.enable(t.type)}),this}},{key:"toggle",value:function(t){return void 0===t?this.visible?this.hide():this.show():t?this.show():this.hide()}},{key:"disablePicking",value:function(){var t=this;return this.bPickable=!1,this.traverse(function(e){e.layers.disable(t.type)}),this}},{key:"enablePicking",value:function(){var t=this;return this.bPickable=!0,this.traverse(function(e){e.layers.enable(t.type)}),this}},{key:"setMaterial",value:function(t){var e=this;return this.userData.cMat=t,this.traverse(function(i){i.isMesh&&(e.userData.cMat=t,i.material=t)}),this}},{key:"getMaterial",value:function(){return this.userData.cMat}},{key:"setDefaultAndHighlightMaterials",value:function(t,e){return this.userData.matSTD=t,this.userData.matHL=e,this}},{key:"highlight",value:function(){return this.userData.matHL&&this.setMaterial(this.userData.matHL),this}},{key:"restoreDefaultMaterial",value:function(){return this.userData.matSTD&&this.setMaterial(this.userData.matSTD),this}},{key:"setOpacity",value:function(t){return this.traverse(function(e){e.isMesh&&(e.material.opacity=t)}),this}},{key:"setEnvMap",value:function(t){return this.traverse(function(e){e.isMesh&&(e.material.envMap=t)}),this}},{key:"assignLightProbe",value:function(t){return this.traverse(function(e){e.isMesh&&e.geometry&&ATON.Utils.assignLightProbeToMesh(t,e)}),this}},{key:"assignLightProbesByProximity",value:function(){return this.traverse(function(t){if(t.isMesh&&t.geometry){var e=new THREE.Vector3,i=((new THREE.Box3).setFromObject(t).getCenter(e),void 0),n=void 0;for(var r in ATON._lps){var o=ATON._lps[r],s=e.distanceToSquared(o.pos);(void 0===i||s<n)&&(n=s,i=o)}i&&ATON.Utils.assignLightProbeToMesh(i,t)}}),this}},{key:"duplicate",value:function(){var t=this.clone();return t.traverse(function(t){t.isMesh&&(t.material=t.material.clone())}),t}},{key:"delete",value:function(){var t=this.parent;void 0!==t&&void 0!==t.nid&&t.removeChild(this)}},{key:"removeChild",value:function(t){if(void 0!==t){t.nid;return void 0!==t.nid&&(this._nodes[t.nid]=void 0),t.parent=void 0,t.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}),this.remove(t),this}}},{key:"removeChildren",value:function(){for(var t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);return this}},{key:"attachTo",value:function(t){var e="string"==typeof t?this._nodes[t]:t;return e&&(e.add(this),e.userData.cMat&&(this.userData.cMat=e.userData.cMat)),e}},{key:"attachToRoot",value:function(){return this._rootG.add(this),this._rootG.userData.cMat&&(this.userData.cMat=this._rootG.userData.cMat),this._rootG}},{key:"getBound",value:function(){var t=(new THREE.Box3).setFromObject(this),e=new THREE.Sphere;return t.getBoundingSphere(e),e}},{key:"setPosition",value:function(t,e,i){return t instanceof THREE.Vector3?this.position.copy(t):this.position.set(t,e,i),this}},{key:"setScale",value:function(t,e,i){return t instanceof THREE.Vector3?this.scale.copy(t):(void 0===e&&(e=t,i=t),this.scale.set(t,e,i)),this}},{key:"setRotation",value:function(t,e,i){return t instanceof THREE.Vector3?this.rotation.copy(t):this.rotation.set(t,e,i),this}},{key:"orientToCamera",value:function(){return this.quaternion.copy(ATON.Nav._qOri),this}},{key:"setYup",value:function(){return this.rotation.set(-1.57079632679,0,0),this}},{key:"load",value:function(t,e){if(void 0===t)return this;var i=this;if(i._bCloneOnLoadHit&&void 0!==ATON._assetsManager[t])return ATON._assetsManager[t].then(function(t){i.add(t.clone()),e&&e()}),console.log("HIT!"),i;i.type===ATON.NTYPES.SCENE&&ATON._assetReqNew(t);var n=new Promise(function(n,r){ATON._aLoader.load(t,function(r){var o=r.scene||r.scene[0];ATON.Utils.modelVisitor(i,o),i.add(o),n(o),console.log("Model "+t+" loaded"),i.type===ATON.NTYPES.SCENE&&ATON._assetReqComplete(t),e&&e()},void 0,function(n){console.log(n),i.type===ATON.NTYPES.SCENE&&ATON._assetReqComplete(t),e&&e()})});return i._bCloneOnLoadHit&&(ATON._assetsManager[t]=n),this}},{key:"exportAs",value:function(t){return ATON.Utils.exportNode(this,t),this}},{key:"setOnHover",value:function(t){return this.onHover=f,this}},{key:"setOnLeave",value:function(t){return this.onLeave=f,this}},{key:"setOnSelect",value:function(t){return this.onSelect=f,this}}]),o}(),d=v;exports.default=d;
},{}],"CwXu":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function i(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var s=function(){function e(i){t(this,e),void 0!==i&&(ATON.Nav.povlist[i]=this,this.id=i),this.pos=new THREE.Vector3(1,0,0),this.target=new THREE.Vector3(0,0,0),this.up=ATON.STD_UPVECTOR,this.fov=ATON.Nav.STD_FOV,this.kwords=void 0,this.nextPOV=void 0,this.prevPOV=void 0}return i(e,[{key:"setPosition",value:function(t,e,i){return t instanceof THREE.Vector3?this.pos.copy(t):this.pos.set(t,e,i),this}},{key:"setTarget",value:function(t,e,i){return t instanceof THREE.Vector3?this.target.copy(t):this.target.set(t,e,i),this}},{key:"setFOV",value:function(t){return this.fov=t,this}},{key:"addKeyword",value:function(t){return void 0===this.kwords&&(this.kwords=[]),this.kwords.push(t),this}},{key:"setKeywords",value:function(t){this.kwords=t}},{key:"setNextPOV",value:function(t){if(t)return this.nextPOV=t,this}},{key:"setPrevPOV",value:function(t){if(t)return this.prevPOV=t,this}}]),e}(),o=s;exports.default=o;
},{}],"MNcy":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=function(){function t(r,n,i){e(this,t),this.pos=new THREE.Vector3(0,0,0),this._res=void 0!==r?r:64,this._near=void 0!==n?n:1,this._far=void 0!==i?i:ATON.Nav.STD_FAR,this._envtex=void 0,this._prevCCtarget=void 0,this._pmremGenerator=new THREE.PMREMGenerator(ATON._renderer)}return r(t,[{key:"setPosition",value:function(e,t,r){return e instanceof THREE.Vector3?this.pos.copy(e):this.pos.set(e,t,r),this}},{key:"update",value:function(){this._envtex&&this._envtex.dispose(),this._prevCCtarget&&this._prevCCtarget.dispose();var e=new THREE.WebGLCubeRenderTarget(this._res,{format:THREE.RGBEFormat,generateMipmaps:!0,minFilter:THREE.LinearMipmapLinearFilter,encoding:THREE.sRGBEncoding}),t=new THREE.CubeCamera(this._near,this._far,e);return t.position.copy(this.pos),t.update(ATON._renderer,ATON._rootVisibleGlobal),this._envtex=e.texture,this._prevCCtarget=e,this}},{key:"getEnvTex",value:function(){return this._envtex}},{key:"assignToNode",value:function(e){}}]),t}(),i=n;exports.default=i;
},{}],"LryX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={init:function(){e.evLocal={},e.evNetwork={},ATON.on=e.on,ATON.fireEvent=e.fireEvent,ATON.clearEventHandlers=e.clearEventHandlers},clearEventHandlers:function(n){e.evLocal[n]=[],e.evNetwork[n]=[]},executeHandlers:function(e,n){if(e)for(var t=0;t<e.length;t++){var o=e[t];o&&o(n)}},on:function(n,t,o){if(void 0!==t){var r=e.evLocal;void 0===r[n]&&(r[n]=[]),r[n].push(t)}void 0!==o&&ATON.VRoadcast.on(n,o)},fireEvent:function(n,t,o){var r=e.evLocal[n];e.executeHandlers(r,t),o&&ATON.VRoadcast.fireEvent(n,t)}},n=e;exports.default=n;
},{}],"R8yv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var a={init:function(){a.materials={},a.colors={},a.addDefaults(),a._loader=new THREE.MaterialLoader},addDefaults:function(){a.colors.white=new THREE.Color(1,1,1),a.colors.black=new THREE.Color(0,0,0),a.colors.green=new THREE.Color(0,1,0),a.colors.yellow=new THREE.Color(1,1,0),a.colors.red=new THREE.Color(1,0,0),a.colors.blue=new THREE.Color(0,0,1),a.colors.orange=new THREE.Color(1,.5,0),a.colors.sem=new THREE.Color(0,0,1),a.colors.darksem=new THREE.Color(0,0,.1),a.materials.fullyTransparent=new THREE.MeshBasicMaterial({transparent:!0,depthWrite:!1,opacity:0}),a.materials.selector=new THREE.MeshBasicMaterial({color:a.colors.green,transparent:!0,opacity:.2,flatShading:!0}),a.materials.controllerRay=new THREE.MeshBasicMaterial({color:a.colors.white,transparent:!0,opacity:.2,flatShading:!0}),a.materials.semanticShape=new THREE.MeshBasicMaterial({color:a.colors.sem,transparent:!0,depthWrite:!1,opacity:.1,flatShading:!0}),a.materials.semanticShapeHL=new THREE.MeshBasicMaterial({color:a.colors.sem,transparent:!0,depthWrite:!1,opacity:.3,flatShading:!0}),a.materials.semanticShapeEdit=new THREE.MeshBasicMaterial({color:a.colors.orange,transparent:!0,depthWrite:!1,opacity:.2,flatShading:!0})},addMaterial:function(e,o){a.materials[e]?console.log("MatHub: material "+e+" already registered"):a.materials[e]=o},loadMaterial:function(e,o){a._loader.load(o,function(o){a.addMaterial(e,o)},void 0,function(a){console.log(a)})},getMaterial:function(e){return a.materials[e]}},e=a;exports.default=e;
},{}],"P9TA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=void 0,o={init:function(){ATON.device={},o.geomUnitSphere=new THREE.SphereBufferGeometry(1,16,16),o.exporter=new THREE.GLTFExporter,o._dlink=document.createElement("a"),o._dlink.style.display="none",document.body.appendChild(o._dlink),o.textureLoader=new THREE.TextureLoader},isConnectionSecure:function(){return window.isSecureContext},isMobile:function(){return ATON.device.isMobile},profileDevice:function(){ATON.device.isMobile=!1;ATON.device.isMobile=!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))),ATON.device.isXRsupported=!1,"xr"in navigator&&navigator.xr.isSessionSupported("immersive-vr").then(function(e){e?(ATON.device.isXRsupported=!0,console.log("WebXR supported")):(ATON.device.isXRsupported=!1,console.log("WebXR NOT supported"))})},getFileExtension:function(e){return e.substr(e.lastIndexOf(".")+1).toLowerCase()},getBaseFolder:function(e){var o=e.lastIndexOf("/");return-1!==o?e.substring(0,o+1):""},modelVisitor:function(o,n){if(!n)return e;var t=o,a=t.type;n.traverse(function(e){void 0!==t.bPickable&&(t.bPickable?e.layers.enable(a):e.layers.disable(a)),e.isMesh&&(a===ATON.NTYPES.SCENE&&(e.geometry&&(e.geometry.computeBoundsTree(),console.log("Computed BVH")),null!==e.material.map&&(e.material.map.anisotropy=ATON._maxAnisotropy,e.material.map.minFilter=THREE.LinearMipmapLinearFilter,e.material.map.magFilter=THREE.LinearFilter)),a===ATON.NTYPES.SEM&&(e.material=ATON.MatHub.materials.semanticShape),t.userData.cMat&&(e.material=t.userData.cMat))})},setVectorPrecision:function(e,o){return e.x=parseFloat(e.x.toPrecision(o)),e.y=parseFloat(e.y.toPrecision(o)),e.z=parseFloat(e.z.toPrecision(o)),e},downloadBlob:function(e,n){void 0!==n&&(o._dlink.href=URL.createObjectURL(e),o._dlink.download=n,o._dlink.click())},downloadText:function(e,n){o.downloadBlob(new Blob([e],{type:"text/plain"}),n)},downloadJSONobj:function(e,n){o.downloadText(JSON.stringify(e),n)},downloadArrayBuffer:function(e,n){o.downloadBlob(new Blob([e],{type:"application/octet-stream"}),n)},exportNode:function(e,n){var t=o.getFileExtension(n);if(!(t.length<1)){var a={binary:"glb"===t};o.exporter.parse(e,function(e){e instanceof ArrayBuffer?o.downloadArrayBuffer(e,n):(console.log(e),o.downloadJSONobj(e,n))},a)}},assignLightProbeToMesh:function(e,o){void 0!==e&&void 0!==o&&(o.noLP||(o.userData.LP=e))},createATONCube:function(e){var n=new THREE.BoxBufferGeometry(1,1,1),t=new THREE.MeshStandardMaterial;o.textureLoader.load(ATON.PATH_RES+"models/aton-cube.jpg",function(e){e.encoding=THREE.sRGBEncoding,t.map=e});var a=ATON.createSceneNode(e);return a.add(new THREE.Mesh(n)),a.setMaterial(t),a.enablePicking(),a},createATONCubePBR:function(e){var n=new THREE.BoxBufferGeometry(1,1,1),t=new THREE.MeshStandardMaterial;t.metalness=1,o.textureLoader.load(ATON.PATH_RES+"models/aton-cube.jpg",function(e){e.encoding=THREE.sRGBEncoding,t.map=e}),o.textureLoader.load(ATON.PATH_RES+"models/aton-cube-pbr.jpg",function(e){e.encoding=THREE.sRGBEncoding,t.metalnessMap=e,t.roughnessMap=e}),o.textureLoader.load(ATON.PATH_RES+"models/aton-cube-nrm.png",function(e){e.encoding=THREE.sRGBEncoding,t.normalMap=e});var a=ATON.createSceneNode(e);return a.add(new THREE.Mesh(n)),a.setMaterial(t),a.enablePicking(),a},createGround:function(e,n,t){void 0===n&&(n=1),void 0===t&&(t=1);var a=new THREE.PlaneBufferGeometry(n,t),i=new THREE.MeshStandardMaterial;void 0!==e&&o.textureLoader.load(e,function(e){e.encoding=THREE.sRGBEncoding,i.map=e});var r=ATON.createSceneNode().rotateX(.5*-Math.PI);return r.add(new THREE.Mesh(a,i)),r.enablePicking(),r}},n=o;exports.default=n;
},{}],"qC8Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={MODE_ADD:0,MODE_DEL:1,init:function(){e.currID=void 0,e.currData=void 0,e._bEdit=!1,e._bLoading=!1,e.initBaseParsers()},setEditMode:function(r){e._bEdit=r},load:function(r,o,t){return e._bLoading=!0,console.log("Loading Scene: "+o),$.getJSON(r,function(r){e.currData=r,e.currID=o,e._bLoading=!1,e.parseScene(r),t&&t(),ATON.fireEvent("SceneJSONLoaded",o)})},parseScene:function(r){if(void 0!==(r=void 0===r?e.currData:r))for(var o in r)e._jsonParsers[o]&&e._jsonParsers[o](r[o])},getJSONchildren:function(e,r){void 0===r&&(r=ATON.NTYPES.SCENE);var o=void 0,t=[];if(r===ATON.NTYPES.SEM&&(o=ATON.getSemanticNode(e)),r===ATON.NTYPES.SCENE&&(o=ATON.getSceneNode(e)),void 0!==o){for(var a in o.children){var i=o.children[a];void 0!==i.nid&&t.push(i.nid)}return t}},getJSONgraphEdges:function(e){void 0===e&&(e=ATON.NTYPES.SCENE);var r=ATON.snodes;e===ATON.NTYPES.SEM&&(r=ATON.semnodes),e===ATON.NTYPES.UI&&(r=ATON.uinodes);var o={};for(var t in r){var a=r[t];a.parent&&a.parent.nid&&(void 0===o[a.parent.nid]&&(o[a.parent.nid]=[]),o[a.parent.nid].push(a.nid))}return o},getJSONsemanticSpheresList:function(e){var r=ATON.getSemanticNode(e);if(void 0!==r){var o=[];for(var t in r.children){var a=r.children[t];a.type&&o.push([parseFloat(a.position.x.toPrecision(3)),parseFloat(a.position.y.toPrecision(3)),parseFloat(a.position.z.toPrecision(3)),parseFloat(a.scale.x.toPrecision(3))])}return o}},getJSONsemanticConvexShapes:function(e){var r=ATON.getSemanticNode(e);if(void 0!==r){var o=[];for(var t in r.children){var a=r.children[t];a.userData._convexPoints&&o.push(a.userData._convexPoints)}return o}},initBaseParsers:function(){e._jsonParsers={},e._jsonParsers.viewpoints=function(e){if(void 0!==e)for(var r in e){var o=e[r];"home"===r?ATON.Nav.setHomePOV((new ATON.POV).setPosition(o.position).setTarget(o.target).setFOV(o.fov).setKeywords(o.keywords)):new ATON.POV(r).setPosition(o.position).setTarget(o.target).setFOV(o.fov).setKeywords(o.keywords)}},e._jsonParsers.scenegraph=function(e){if(void 0!==e){var r=e.nodes,o=e.edges,t=function(e){var o=r[e],t=ATON.getOrCreateSceneNode(e).removeChildren(),a=o.urls;a&&(Array.isArray(a)?a.forEach(function(e){ATON.createSceneNode().load(ATON.PATH_COLLECTION+e).attachTo(t)}):t.load(ATON.PATH_COLLECTION+a)),o.toYup&&t.setYup();var i=o.transform;i&&(i.position&&t.setPosition(i.position[0],i.position[1],i.position[2]),i.rotation&&t.setRotation(i.rotation[0],i.rotation[1],i.rotation[2]),i.scale&&t.setScale(i.scale[0],i.scale[1],i.scale[2]))};for(var a in r)t(a);for(var i in o){var n=o[i],s=ATON.getSceneNode(i);if(void 0!==s)for(var d in n){var c=n[d],v=ATON.getSceneNode(c);void 0!==v&&v.attachTo(s)}}}},e._jsonParsers.semanticgraph=function(e){if(void 0!==e){var r=e.nodes,o=e.edges,t=function(e){var o=r[e],t=ATON.getOrCreateSemanticNode(e).removeChildren(),a=o.urls;a&&(Array.isArray(a)?a.forEach(function(e){ATON.createSemanticNode().load(ATON.PATH_COLLECTION+e).attachTo(t)}):t.load(ATON.PATH_COLLECTION+a)),o.toYup&&t.setYup();var i=o.spheres;if(Array.isArray(i))for(var n in i){var s=i[n];ATON.SemFactory.createSphere(e,new THREE.Vector3(s[0],s[1],s[2]),s[3])}var d=o.convexshapes;if(Array.isArray(d))for(var c in d){for(var v=d[c],N=[],O=0;O<v.length;O+=3){var T=new THREE.Vector3(v[O],v[O+1],v[O+2]);N.push(T)}ATON.SemFactory.createConvexShape(e,N)}};for(var a in r)t(a);for(var i in o){var n=o[i],s=ATON.getSemanticNode(i);if(void 0!==s)for(var d in n){var c=n[d],v=ATON.getSemanticNode(c);void 0!==v&&v.attachTo(s)}}}}},addSceneParser:function(r,o){e._jsonParsers[r]=o},sendEdit:function(r,o,t){if(!e._bLoading&&e._bEdit&&void 0!==r){void 0===o&&(o=e.MODE_ADD);var a=e.currID,i={};i.sid=a,i.data=r,i.mode=o===e.MODE_DEL?"DEL":"ADD";var n=JSON.stringify(i);$.ajax({url:ATON.PATH_RESTAPI+"edit/scene",type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){void 0!==r&&(e.currData=r,t&&t())}})}}},r=e;exports.default=r;
},{}],"nomA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function(e){return(1-Math.cos(e*Math.PI))/2},r={STD_FOV:50,STD_NEAR:.05,STD_FAR:1e3,FP_EPS:.01,STD_ROT_SPEED_ORBIT:.4,STD_ROT_SPEED_FP:-.3,STD_POV_TRANS_DURATION:2,MODE_ORBIT:0,MODE_FP:1,MODE_DEVORI:2};r.POVtransitionDuration=r.STD_POV_TRANS_DURATION,r.init=function(){r._mode=void 0,r.setOrbitControl(),r._currPOV=new ATON.POV,r._fromPOV=new ATON.POV,r._reqPOV=new ATON.POV,r.homePOV=void 0,r._tPOVcall=-1,r._tPOVprogress=0,r.povlist={},r._vDir=new THREE.Vector3(1,0,0),r._qOri=new THREE.Quaternion,r._motionAmt=0,r._motionDir=new THREE.Vector3(0,1,0)},r.getCurrentEyeLocation=function(){return r._currPOV.pos},r.isTransitioning=function(){return r._tPOVcall>=0},r.isOrbit=function(){return r._mode===r.MODE_ORBIT},r.isFirstPerson=function(){return r._mode===r.MODE_FP},r.isDevOri=function(){return r._mode===r.MODE_DEVORI},r.setOrbitControl=function(){if(!ATON.XR.isPresenting()){if(r._mode=r.MODE_ORBIT,void 0===r._cOrbit){r._camOrbit=new THREE.PerspectiveCamera(r.STD_FOV,window.innerWidth/window.innerHeight,r.STD_NEAR,r.STD_FAR),r._camOrbit.layers.enableAll(),r._cOrbit=new THREE.OrbitControls(r._camOrbit,ATON._renderer.domElement);var e=r._cOrbit;e.rotateSpeed=r.STD_ROT_SPEED_ORBIT,e.enablePan=!0,e.enableDamping=!0,e.dampingFactor=.1,e.screenSpacePanning=!0,e.enableZoom=!0,e.minDistance=.03,e.maxDistance=1e3,e.addEventListener("change",function(){r._bControlChange=!0})}r._controls=r._cOrbit,r._camera=r._camOrbit,r._controls.update(),r._currPOV&&r.syncCurrCamera()}},r.setFirstPersonControl=function(){if(!ATON.XR.isPresenting()){if(r._mode=r.MODE_FP,void 0===r._cFirstPerson){r._camFP=new THREE.PerspectiveCamera(r.STD_FOV,window.innerWidth/window.innerHeight,r.STD_NEAR,r.STD_FAR),r._camFP.layers.enableAll(),r._cFirstPerson=new THREE.OrbitControls(r._camFP,ATON._renderer.domElement);var e=r._cFirstPerson;e.enableZoom=!1,e.enablePan=!1,e.rotateSpeed=r.STD_ROT_SPEED_FP,e.enableDamping=!0,e.dampingFactor=.1,e.target.copy(r._camera.position),e.minDistance=.05,e.maxDistance=.05}r._controls=r._cFirstPerson,r._camera=r._camFP,r._controls.update(),r._currPOV&&r.syncCurrCamera()}},r.setDeviceOrientationControl=function(){ATON.Utils.isMobile()&&(r._mode=r.MODE_DEVORI,ATON._screenPointerCoords.set(0,0),void 0===r._cDevOri&&(r._camDevOri=new THREE.PerspectiveCamera(r.STD_FOV,window.innerWidth/window.innerHeight,r.STD_NEAR,r.STD_FAR),r._camDevOri.layers.enableAll(),r._cDevOri=new THREE.DeviceOrientationControls(r._camDevOri,ATON._renderer.domElement),r._cDevOri.alphaOffset=0),r._controls=r._cDevOri,r._camera=r._camDevOri,r._controls.update(),r._currPOV&&r.syncCurrCamera())},r.setMotionAmount=function(e){r._motionAmt=e},r.setMotionDirection=function(e){r._motionDir.copy(e)},r.stop=function(){r._motionAmt=0},r.setFOV=function(e){if(!ATON.XR.isPresenting()){r._currPOV.fov=e;var t=r._camera;t.fov=e,t.updateProjectionMatrix()}},r.getFOV=function(){return r._currPOV.fov},r.syncCurrPOV=function(){if(ATON.XR.isPresenting()){var e=ATON._renderer.xr.getCamera(r._camera);return e.getWorldPosition(r._currPOV.pos),e.getWorldQuaternion(r._qOri),void e.getWorldDirection(r._vDir)}var t=r._controls,o=r._camera;if(o.getWorldDirection(r._vDir),o.getWorldQuaternion(r._qOri),r._mode!==r.MODE_DEVORI){if(r._mode===r.MODE_FP)return r._currPOV.pos.copy(t.target),r._currPOV.target.x=r._currPOV.pos.x+r._vDir.x,r._currPOV.target.y=r._currPOV.pos.y+r._vDir.y,void(r._currPOV.target.z=r._currPOV.pos.z+r._vDir.z);r._currPOV.pos.copy(o.position),r._currPOV.target.copy(t.target)}else r._currPOV.pos.copy(o.position)},r.handlePOV=function(){ATON.XR.isPresenting()?r.handleXRtransition():r.handlePOVtransition(),r.handleMotion()},r.handleMotion=function(){if(!r.isTransitioning()&&0!=r._motionAmt){ATON.XR.controller0&&ATON.XR.controller0.visible?(ATON.XR.controller0.getWorldDirection(r._motionDir),r._motionDir.negate()):r._motionDir.copy(r._vDir);var e=r._motionDir.clone();e.multiplyScalar(r._motionAmt*ATON._dt),r._currPOV.pos.add(e),r._currPOV.target.add(e)}},r.handlePOVtransition=function(){if(!(r._tPOVcall<0)){if(r.POVtransitionDuration<=0?r._tPOVprogress=1:r._tPOVprogress=(ATON._clock.elapsedTime-r._tPOVcall)/r.POVtransitionDuration,r._tPOVprogress>=1)return r._tPOVcall=-1,r._currPOV.pos.copy(r._reqPOV.pos),r._currPOV.target.copy(r._reqPOV.target),r._currPOV.fov=r._reqPOV.fov,void ATON.fireEvent("POVTransitionCompleted",r._reqPOV.id);r._tPOVprogress=e(r._tPOVprogress),r._currPOV.pos.lerpVectors(r._fromPOV.pos,r._reqPOV.pos,r._tPOVprogress),r._currPOV.target.lerpVectors(r._fromPOV.target,r._reqPOV.target,r._tPOVprogress),r._fromPOV.fov&&r._reqPOV.fov&&(r._currPOV.fov=THREE.MathUtils.lerp(r._fromPOV.fov,r._reqPOV.fov,r._tPOVprogress),r._camera.fov=r._currPOV.fov,r._camera.updateProjectionMatrix())}},r.handleXRtransition=function(){if(!(r._tPOVcall<0)){if(r.POVtransitionDuration<=0?r._tPOVprogress=1:r._tPOVprogress=(ATON._clock.elapsedTime-r._tPOVcall)/r.POVtransitionDuration,r._tPOVprogress>=1)return r._tPOVcall=-1,console.log("XR height"+ATON.XR._currPos.y),console.log("HMD height"+r._currPOV.pos.y),void ATON.fireEvent("POVTransitionCompleted",r._reqPOV.id);ATON.XR._currPos.lerpVectors(ATON.XR._fromPos,ATON.XR._reqPos,r._tPOVprogress)}},r.syncCurrCamera=function(){var e=r._controls,t=r._camera,o=r._currPOV.pos,n=r._currPOV.target;ATON.XR.isPresenting()||(r._mode!==r.MODE_DEVORI?(r._vDir.subVectors(n,o),r._vDir.normalize(),r._mode===r.MODE_FP?(e.target.copy(o),t.position.x=e.target.x-r._vDir.x*r.FP_EPS,t.position.y=e.target.y-r._vDir.y*r.FP_EPS,t.position.z=e.target.z-r._vDir.z*r.FP_EPS):(t.position.copy(o),e.target.copy(n))):t.position.copy(o))},r.update=function(){r.syncCurrPOV(),r.handlePOV(),r.syncCurrCamera()},r.requestPOV=function(e,t){ATON._tPOVcall>=0||(ATON.fireEvent("POVTransitionRequested",e.id),void 0!==t&&(r.POVtransitionDuration=t),r._tPOVcall=ATON._clock.elapsedTime,ATON.XR.isPresenting()?(r._reqPOV.pos.copy(e.pos?e.pos:r._currPOV.pos),r._fromPOV.pos.copy(r._currPOV.pos),ATON.XR._reqPos.copy(e.pos?e.pos:r._currPOV.pos),ATON.XR._fromPos.copy(ATON.XR._currPos)):(r._reqPOV.pos.copy(e.pos?e.pos:r._currPOV.pos),r._reqPOV.target.copy(e.target?e.target:r._currPOV.target),r._reqPOV.fov=e.fov?e.fov:r._currPOV.fov,r._fromPOV.pos.copy(r._currPOV.pos),r._fromPOV.target.copy(r._currPOV.target),r._fromPOV.fov=r._currPOV.fov))},r.requestPOVbyBound=function(e,t){if(void 0!==e){var o=new THREE.Vector3,n=new THREE.Vector3;o.copy(e.center);var i=2.5*e.radius;n.x=o.x-i*r._vDir.x,n.y=o.y-i*r._vDir.y,n.z=o.z-i*r._vDir.z;var a=(new ATON.POV).setPosition(n).setTarget(o);r.requestPOV(a,t)}},r.requestPOVbyNode=function(e,t){if(void 0!==e){var o=e.getBound();r.requestPOVbyBound(o,t)}},r.requestRetarget=function(e,t,o){var n=new THREE.Vector3;if(void 0===t)n.lerpVectors(e,r._currPOV.pos,.8);else{var i=e.distanceTo(r._currPOV.pos);i*=.5,n.x=e.x+t.x*i,n.y=e.y+t.y*i,n.z=e.z+t.z*i}var a=(new ATON.POV).setPosition(n).setTarget(e).setFOV(r._currPOV.fov);console.log(a),r.requestPOV(a,o)},r.computeDefaultHome=function(e){void 0===e&&(e=new THREE.Vector3(1,.7,1));var t=ATON.getRootScene().getBound(),o=new THREE.Vector3(t.center.x+t.radius*e.x,t.center.y+t.radius*e.y,t.center.z+t.radius*e.z);r.homePOV=(new ATON.POV).setPosition(o).setTarget(t.center)},r.setHomePOV=function(e){r.homePOV=e},r.computeAndRequestDefaultHome=function(e,t){r.computeDefaultHome(t),r.requestPOV(r.homePOV,e)},r.requestHome=function(e){r.requestPOV(r.homePOV,e)},r.DeviceOrientationControls=function(e){var r=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0,this.absolute=!1,this.alphaOffsetDevice=void 0,this.alphaOffsetScreen=void 0;var t,o,n,i,a=function(e){r.absolute||(r.deviceOrientation=e)},s=function(e){r.deviceOrientation=e,r.absolute=!0},c=function(){r.screenOrientation=window.orientation||0},O=(t=new THREE.Vector3(0,0,1),o=new THREE.Euler,n=new THREE.Quaternion,i=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,r,a,s,c){o.set(a,r,-s,"YXZ"),e.setFromEuler(o),e.multiply(i),e.multiply(n.setFromAxisAngle(t,-c))});this.connect=function(){c(),window.addEventListener("orientationchange",c,!1),window.addEventListener("deviceorientation",a,!1),window.addEventListener("deviceorientationabsolute",s,!1),r.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",c,!1),window.removeEventListener("deviceorientation",a,!1),window.removeEventListener("deviceorientationabsolute",s,!1),r.enabled=!1},this.update=function(){var e;if(!1!==r.enabled&&(e=r.deviceOrientation)){var t=this.getDirection()?THREE.Math.degToRad(this.getDirection())+r.alphaOffset:0,o=e.beta?THREE.Math.degToRad(e.beta):0,n=e.gamma?THREE.Math.degToRad(e.gamma):0,i=r.screenOrientation?THREE.Math.degToRad(r.screenOrientation):0;O(r.object.quaternion,t,o,n,i)}},this.dispose=function(){r.disconnect()},this.iOSOrientationPermission=function(){"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then(function(e){console.log(e)}).catch(console.error)},this.getDirection=function(){return void 0!==r.deviceOrientation.webkitCompassHeading?r.deviceOrientation.webkitCompassHeading:r.deviceOrientation.alpha},this.getDirectionMap=function(){return void 0!==r.deviceOrientation.webkitCompassHeading?360-r.deviceOrientation.webkitCompassHeading:r.deviceOrientation.alpha},this.connect()};var t=r;exports.default=t;
},{}],"jROx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={STD_TELEP_DURATION:.03,isPresenting:function(){return e._bPresenting},init:function(){ATON._renderer.xr.enabled=!0,ATON._renderer.xr.setReferenceSpaceType("local"),ATON.device.isMobile&&ATON._renderer.xr.setFramebufferScaleFactor(.5),e._bPresenting=!1,e.currSession=null,e.rig=new THREE.Group,e.rig.add(ATON.Nav._camera),ATON._rootUI.add(e.rig),e._currPos=e.rig.position,e._fromPos=new THREE.Vector3,e._reqPos=new THREE.Vector3,e.gControllers=void 0,e.controller0pos=new THREE.Vector3,e.controller1pos=new THREE.Vector3,e.controller0dir=new THREE.Vector3,e.controller1dir=new THREE.Vector3,ATON.on("XRselectStart",function(r){e.defaultSelectHandler(r)}),ATON.on("XRselectEnd",function(e){})},defaultSelectHandler:function(r){if(ATON._queryDataScene){var o=ATON._queryDataScene.p;ATON._queryDataScene.n.y>.7&&ATON.Nav.requestPOV((new ATON.POV).setPosition(o.x,o.y+ATON.userHeight,o.z),e.STD_TELEP_DURATION)}},_handleUISelection:function(){if(void 0===ATON._hoveredUI)return!1;var e=ATON.getUINode(ATON._hoveredUI);return e&&e.onSelect&&e.onSelect(),!0},setRefSpaceLocation:function(r){e.rig.position.copy(r)},onSessionStarted:function(r){r.addEventListener("end",e.onSessionEnded),ATON._renderer.xr.setSession(r),e.currSession=r,e.controller0=ATON._renderer.xr.getController(0),e.controller1=ATON._renderer.xr.getController(1),e.controller0&&(e.controller0.addEventListener("connected",function(r){e.controller0.visible=!0,e.controller0.gamepad=r.data.gamepad}),e.controller0.addEventListener("selectstart",function(){e._handleUISelection()||ATON.fireEvent("XRselectStart",0)}),e.controller0.addEventListener("selectend",function(){ATON.fireEvent("XRselectEnd",0)})),e.controller1&&(e.controller1.addEventListener("connected",function(r){e.controller1.visible=!0,e.controller1.gamepad=r.data.gamepad}),e.controller1.addEventListener("selectstart",function(){ATON.fireEvent("XRselectStart",1)}),e.controller1.addEventListener("selectend",function(){ATON.fireEvent("XRselectEnd",1)})),e.setRefSpaceLocation(ATON.Nav._currPOV.pos),e._bPresenting=!0,console.log("XR now presenting"),e.setupControllersUI(),ATON.fireEvent("XRmode",!0)},onSessionEnded:function(){e.currSession.removeEventListener("end",e.onSessionEnded),e.currSession=null,e._bPresenting=!1,e.setRefSpaceLocation(new THREE.Vector3(0,0,0)),ATON.fireEvent("XRmode",!1),console.log("Quit XR")},toggle:function(){if(ATON.device.isXRsupported)if(null===e.currSession){navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local"]}).then(e.onSessionStarted)}else e.currSession.end()},setupControllersUI:function(){if(!e.gControllers){var r=new THREE.CylinderBufferGeometry(.003,.003,10,5);r.rotateX(-Math.PI/2),r.translate(0,0,-5);var o=new THREE.Mesh(r,ATON.MatHub.materials.controllerRay);e.controller0.add(o.clone()),e.gControllers=ATON.createUINode(),e.gControllers.add(e.controller0),e.gControllers.add(e.controller1),e.controller0.visible=!1,e.controller1.visible=!1,e.gControllers.disablePicking(),e.rig.add(e.gControllers)}},getControllerSpace:function(r){1===r?e.getControllerGrip(1):e.getControllerGrip(0)},getControllerWorldLocation:function(r){return 1===r?e.controller1pos:e.controller0pos},getControllerWorldDirection:function(r){return 1===r?e.controller1dir:e.controller0dir},update:function(){e.controller0.visible&&(e.controller0.getWorldPosition(e.controller0pos),e.controller0.getWorldDirection(e.controller0dir),e.controller0dir.negate()),e.controller1.visible&&(e.controller1.getWorldPosition(e.controller1pos),e.controller1.getWorldDirection(e.controller1dir),e.controller1dir.negate())}},r=e;exports.default=r;
},{}],"fWYX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./ATON.node.js"));function e(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=f();return function(){var n,o=h(t);if(e){var r=h(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(e){c(r,t.default);var n=a(r);function r(t){var e;return o(this,r),(e=n.call(this,t,ATON.NTYPES.UI)).baseColor=ATON.MatHub.colors.black,e.switchColor=ATON.MatHub.colors.green,e._bSwitched=!1,e.container=new ThreeMeshUI.Block({width:.1,height:.1,padding:.01,borderRadius:.02,backgroundColor:e.baseColor,backgroundOpacity:.5,fontFamily:ATON.PATH_RES+"fonts/custom-msdf.json",fontTexture:ATON.PATH_RES+"fonts/custom.png",justifyContent:"center",alignContent:"center"}),e.add(e.container),e.uiText=new ThreeMeshUI.Text({content:"button",fontSize:.02,fontColor:ATON.MatHub.colors.white}),e.container.add(e.uiText),e._trigger=new THREE.Mesh(new THREE.PlaneGeometry(.9*ATON.SUI.STD_BTN_SIZE,.9*ATON.SUI.STD_BTN_SIZE,2),ATON.MatHub.materials.fullyTransparent),e._trigger.position.set(0,0,.002),e.add(e._trigger),e.onHover=function(){e.container.set({backgroundOpacity:.8})},e.onLeave=function(){e.container.set({backgroundOpacity:.5})},e.enablePicking(),e}return i(r,[{key:"setBaseColor",value:function(t){return this.baseColor=t,this._bSwitched||this.container.set({backgroundColor:this.baseColor}),this}},{key:"setSwitchColor",value:function(t){return this.switchColor=t,this._bSwitched&&this.container.set({backgroundColor:this.switchColor}),this}},{key:"setText",value:function(t){return this.uiText.set({content:t}),this}},{key:"switch",value:function(t){return this._bSwitched=t,t?this.container.set({backgroundColor:this.switchColor}):this.container.set({backgroundColor:this.baseColor}),this}},{key:"setIcon",value:function(t){var e=this;return ATON.Utils.textureLoader.load(t,function(t){e._trigger.material=new THREE.MeshStandardMaterial({map:t,transparent:!0,depthWrite:!1}),e.uiText.position.set(0,-.035,0)}),this}}]),r}();exports.default=b;
},{"./ATON.node.js":"XTSP"}],"xSlA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./ATON.sui.button.js"));function o(e){return e&&e.__esModule?e:{default:e}}var t={STD_BTN_SIZE:.1};t.Button=e.default,t.init=function(){t.mainSelector=ATON.createUINode(),t.mainSelector.add(new THREE.Mesh(ATON.Utils.geomUnitSphere,ATON.MatHub.getMaterial("selector"))),t.mainSelector.disablePicking(),t.setSelectorRadius(.05),t.mainSelector.visible=!1,ATON._rootUI.add(t.mainSelector),t.gPoints=ATON.createUINode(),ATON._rootUI.add(t.gPoints),t.buildInfoNode(),t.bShowInfo=!0,t._labelScale=ATON.Utils.isMobile()?1.5:1,t._labelScaleVR=2,ATON.on("SemanticNodeHover",function(e){t.bShowInfo&&t.infoNodeText.set({content:e})})},t.setSelectorRadius=function(e){t.mainSelector.scale.set(e,e,e)},t.getSelectorRadius=function(){return t.mainSelector.scale.x},t.buildInfoNode=function(){t.infoNode=ATON.createUINode(),t.infoNode.attachToRoot(),t.infoContainer=new ThreeMeshUI.Block({width:.15,height:.05,padding:.01,borderRadius:.02,fontFamily:ATON.PATH_RES+"fonts/custom-msdf.json",fontTexture:ATON.PATH_RES+"fonts/custom.png",alignContent:"center",justifyContent:"center"}),t.infoNode.add(t.infoContainer),t.infoNodeText=new ThreeMeshUI.Text({content:"Info",fontSize:.02,fontColor:ATON.MatHub.colors.white}),t.infoContainer.add(t.infoNodeText)},t.getInfoNode=function(){return t.infoNode},t.createToolbar=function(e,o){var n=ATON.createUINode(),i=e.length,a=.3*t.STD_BTN_SIZE,r=new ThreeMeshUI.Block({width:t.STD_BTN_SIZE*i+a,height:t.STD_BTN_SIZE+a,padding:.01,borderRadius:.02,backgroundColor:o||ATON.MatHub.colors.black,backgroundOpacity:.3,fontFamily:ATON.PATH_RES+"fonts/custom-msdf.json",fontTexture:ATON.PATH_RES+"fonts/custom.png",alignContent:"center",justifyContent:"center"}),d=.5*i*t.STD_BTN_SIZE;d-=.5*t.STD_BTN_SIZE;for(var l=0;l<i;l++){var s=e[l];s.position.set(l*t.STD_BTN_SIZE-d,0,.01),r.add(s)}return n.add(r),n},t.update=function(){ATON.Nav.isTransitioning()?t.infoNode.visible=!1:(ThreeMeshUI.update(),ATON._queryDataScene?(t.mainSelector.visible=!0,t.mainSelector.position.copy(ATON._queryDataScene.p)):t.mainSelector.visible=!1,ATON._queryDataSem?(ATON.XR._bPresenting?(t.infoNode.position.copy(ATON.XR.controller0pos),t.infoNode.setScale(t._labelScaleVR)):(t.infoNode.position.lerpVectors(ATON._queryDataSem.p,ATON.Nav._currPOV.pos,.2),t.infoNode.setScale(ATON._queryDataSem.d*t._labelScale)),t.infoNode.orientToCamera(),t.bShowInfo&&(t.infoNode.visible=!0),t.mainSelector.visible=!1):t.infoNode.visible=!1)};var n=t;exports.default=n;
},{"./ATON.sui.button.js":"fWYX"}],"Qwfv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./ATON.node.js"));function e(t){return t&&t.__esModule?t:{default:t}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=h();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?c(t):e}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(e){i(o,t.default);var r=u(o);function o(t){var e;return n(this,o),(e=r.call(this,void 0,ATON.NTYPES.UI)).userid=t,e.username="anonymous",e.message="...",e.bTalking=!1,e._tStateCall=-1,e._tStateDur=.1,e._tProgress=0,e._currState={},e._currState.position=new THREE.Vector3,e._currState.quaternion=new THREE.Quaternion,e._tgtState=void 0,e.realize(),e}return s(o,[{key:"getAvatarMaterialByUID",value:function(t){var e=ATON.MatHub.materials.avatars;return e[t%e.length]}},{key:"realize",value:function(){var t=new THREE.SphereGeometry(.2,16,16);this.usermaterial=this.getAvatarMaterialByUID(this.userid);var e=new THREE.Mesh(t,this.usermaterial);this.usermeshnode=ATON.createUINode(),this.usermeshnode.add(e),this.usermeshnode.setMaterial(this.usermaterial),this.usermeshnode.setCloneOnLoadHit(!1),this.userlabelnode=ATON.createUINode(),this.labelcontainer=new ThreeMeshUI.Block({width:.7,height:.25,padding:.03,borderRadius:.05,backgroundColor:ATON.VRoadcast.ucolorsdark[this.userid%ATON.VRoadcast.ucolorsdark.length],fontFamily:ATON.PATH_RES+"fonts/custom-msdf.json",fontTexture:ATON.PATH_RES+"fonts/custom.png"}),this.userlabelnode.position.y=.4,this.userlabelnode.add(this.labelcontainer),this.usernametext=new ThreeMeshUI.Text({content:"User #"+this.userid,fontSize:.09,fontColor:ATON.MatHub.colors.white}),this.usernametext.position.y=0,this.usermessagetext=new ThreeMeshUI.Text({content:"\nHello World!",fontSize:.03,fontColor:ATON.MatHub.colors.white}),this.usermessagetext.position.y=-.03,this.labelcontainer.add(this.usernametext),this.labelcontainer.add(this.usermessagetext),this.add(this.usermeshnode),this.add(this.userlabelnode)}},{key:"loadRepresentation",value:function(t){var e=this;return void 0!==e.usermeshnode.children[0]&&e.usermeshnode.remove(e.usermeshnode.children[0]),e.usermeshnode.load(t),this}},{key:"setUsername",value:function(t){return this.username=t,this.usernametext.set({content:t}),this}},{key:"setMessage",value:function(t){return this.message=t,this.usermessagetext.set({content:"\n"+t}),this}},{key:"requestStateTransition",value:function(t){this._tStateCall>=0||(this._tStateCall=ATON._clock.elapsedTime,this._currState.position.copy(this.position),this._currState.quaternion.copy(this.quaternion),this._tgtState=t)}},{key:"handleStateTransition",value:function(){if(!(this._tStateCall<0)){var t=this._tStateDur;this._tProgress=t<=0?1:(ATON._clock.elapsedTime-this._tStateCall)/t;var e=this._currState,r=this._tgtState;if(this._tProgress>=1)return this._tStateCall=-1,this.position.copy(r.position),void this.usermeshnode.quaternion.copy(r.quaternion);this.position.lerpVectors(e.position,r.position,this._tProgress),this.usermeshnode.quaternion.slerp(r.quaternion,this._tProgress)}}},{key:"update",value:function(){this.handleStateTransition();var t=ATON.Nav._camera,e=ATON.Nav._currPOV.pos;void 0!==t&&void 0!==e&&this.userlabelnode.orientToCamera()}}]),o}();exports.default=d;
},{"./ATON.node.js":"XTSP"}],"mY3J":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("./ATON.avatar.js"));function o(e){return e&&e.__esModule?e:{default:e}}var t={USER_STATE_FREQ:.25,REPLICATED_EVT:"EREP",THRES_STATE_POS:.01,THRES_STATE_ORI:.08};t.Avatar=e.default,t.init=function(){t.address=window.location.origin,t.initMaterials(),t.socket=void 0,t._connected=!1,t.uid=void 0,t.avatarList=[],t.avaGroup=ATON.createUINode("avatars"),t.avaGroup.attachToRoot(),window.setInterval(t.sendState,1e3*t.USER_STATE_FREQ),t._lastStateSent=void 0,console.log("VRoadcast initialized")},t.initMaterials=function(){t.ucolors=[],t.ucolors.push(new THREE.Color(1,0,0)),t.ucolors.push(new THREE.Color(1,1,0)),t.ucolors.push(new THREE.Color(0,1,0)),t.ucolors.push(new THREE.Color(0,1,1)),t.ucolors.push(new THREE.Color(0,0,1)),t.ucolors.push(new THREE.Color(1,0,1)),t.ucolorsdark=[],t.ucolorsdark.push(new THREE.Color(.2,0,0)),t.ucolorsdark.push(new THREE.Color(.2,.2,0)),t.ucolorsdark.push(new THREE.Color(0,.2,0)),t.ucolorsdark.push(new THREE.Color(0,.2,.2)),t.ucolorsdark.push(new THREE.Color(0,0,.2)),t.ucolorsdark.push(new THREE.Color(.2,0,.2));var e=ATON.MatHub.materials;e.avatars=[];var o=new THREE.MeshStandardMaterial({color:t.ucolors[0],transparent:!0,opacity:.4,depthWrite:!1,flatShading:!0});e.avatars.push(o);for(var n=1;n<t.ucolors.length;n++){var r=o.clone();r.color=t.ucolors[n],e.avatars.push(r)}},t.fireEvent=function(e,o){if(t._connected){var n=t.socket;n&&n.emit(t.REPLICATED_EVT,{e:e,d:o})}},t.on=function(e,o){if(void 0!==o){var t=ATON.EventHub.evNetwork;void 0===t[e]&&(t[e]=[]),t[e].push(o)}},t.isConnected=function(){return t._connected},t.requestSceneEnter=function(e){t.socket&&(void 0===e&&(e=ATON.SceneHub.currID),void 0!==e?t.socket.emit("SENTER",e):console.log("VRC ERROR: current scene ID is undefined"))},t.connect=function(e){e&&(t.address=e);var o={};"https:"===window.location.protocol?(o.path="/svrc/socket.io",o.secure=!0,o.rejectUnauthorized=!1):o.path="/vrc/socket.io",t.socket=io.connect(t.address,o),void 0!==t.socket&&(t._connected=t.socket.connected,t._registerSocketHandlers())},t._onConnected=function(){},t.setUsername=function(e){t._username=e,void 0!==t.socket&&t.socket.emit("UNAME",e)},t._registerSocketHandlers=function(){t.socket.on("connect",function(){t._connected=!0,void 0!==ATON.SceneHub.currID&&t.requestSceneEnter(),console.log("VRC connected, entering scene: "+ATON.SceneHub.currID),ATON.fireEvent("VRC_Connected"),t._onConnected()}),t.socket.on("disconnect",function(){t._connected=!1,t.uid=void 0,t.avaGroup.hide(),console.log("VRC disconnected!"),ATON.fireEvent("VRC_Disconnected")}),t.socket.on(t.REPLICATED_EVT,function(e){var o=e.e,t=e.d,n=ATON.EventHub.evNetwork[o];ATON.EventHub.executeHandlers(n,t)}),t.socket.on("ID",function(e){console.log("Your ID is "+e),t.uid=e,ATON.fireEvent("VRC_IDassigned",e.id)}),t.socket.on("UENTER",function(e){var o=e;console.log("User #"+o+" entered the scene"),t.touchAvatar(o)}),t.socket.on("ULEAVE",function(e){var o=e,n=t.avatarList[o];n&&n.hide(),console.log("User #"+o+" left the scene")}),t.socket.on("USTATE",function(e){var o=t.decodeState(e),n=o.userid;t.touchAvatar(n).requestStateTransition(o)}),t.socket.on("UNAME",function(e){var o=e.uid,n=e.name;t.touchAvatar(o).setUsername(n),console.log("User #"+o+" changed username to: "+n)})},t.encodeState=function(e){if(e){var o=new Float32Array(6);o[0]=e.position.x,o[1]=e.position.y,o[2]=e.position.z;var t=new Int8Array(o.buffer);return t[16]=128*e.quaternion.x,t[17]=128*e.quaternion.y,t[18]=128*e.quaternion.z,t[19]=128*e.quaternion.w,t[20]=e.userid,t}},t.decodeState=function(e){var o={};o.userid=e[20],o.quaternion=new THREE.Quaternion(e[16]/128,e[17]/128,e[18]/128,e[19]/128);for(var t=new Int8Array(16),n=0;n<16;n++)t[n]=e[n];var r=new Float32Array(t.buffer);return o.position=new THREE.Vector3(r[0],r[1],r[2]),o},t.update=function(){for(var e=0;e<t.avatarList.length;e++){var o=t.avatarList[e];o&&o.visible&&(o._tStateDur=t.USER_STATE_FREQ,o.update())}},t.sendState=function(){if(void 0!==t.uid&&t.socket&&t._connected){var e=ATON.Nav._currPOV;if(e){var o={};if(o.position=new THREE.Vector3,o.quaternion=new THREE.Quaternion,o.position.copy(e.pos),o.quaternion.copy(ATON.Nav._qOri),o.userid=t.uid,void 0!==t._lastStateSent){var n=t._lastStateSent.position,r=t._lastStateSent.quaternion,a=n.distanceToSquared(e.pos),c=r.angleTo(ATON.Nav._qOri);if(a<t.THRES_STATE_POS&&c<t.THRES_STATE_ORI)return}var i=t.encodeState(o);t.socket.emit("USTATE",i),t._lastStateSent=o}}},t.getAvatar=function(e){return t.avatarList[e]},t.touchAvatar=function(e){if(void 0===t.avatarList[e]){var o=new t.Avatar(e);o.attachTo(t.avaGroup),o.loadRepresentation(ATON.PATH_RES+"models/vrc/head.gltf"),t.avatarList[e]=o}var n=t.avatarList[e];return n.show(),n},t.clearAllAvatars=function(){for(var e in t.avatarList){t.avatarList[e].hide()}};var n=t;exports.default=n;
},{"./ATON.avatar.js":"Qwfv"}],"dQQK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={init:function(){e.bConvexBuilding=!1,e.convexPoints=[],e.convexNode=void 0,e.currConvexMesh=void 0,e.currSemNode=ATON.createSemanticNode(),e.currSemNode.disablePicking(),e.currSemNode.attachToRoot(),e.currMaterial=ATON.MatHub.getMaterial("semanticShape"),e._numShapes=0},resetMaterial:function(){e.currMaterial=ATON.MatHub.getMaterial("semanticShape")},setMaterial:function(t){void 0!==t&&(e.currMaterial=t)},addConvexPoint:function(t){e.convexPoints.push(t);var r=e.convexPoints.length,n=new THREE.Mesh(ATON.Utils.geomUnitSphere,ATON.MatHub.getMaterial("semanticShapeEdit"));if(n.position.copy(t),n.scale.set(.01,.01,.01),ATON.SUI.gPoints.add(n),r<4)return!1;var a=new THREE.ConvexBufferGeometry(e.convexPoints),i=new THREE.Mesh(a,ATON.MatHub.getMaterial("semanticShapeEdit"));if(e.bConvexBuilding){var o=e.currConvexMesh;o.geometry.dispose(),o.geometry=a,ATON.Utils.setVectorPrecision(t,4),o.userData._convexPoints.push(t.x),o.userData._convexPoints.push(t.y),o.userData._convexPoints.push(t.z)}else{e.currSemNode.add(i),i.userData._convexPoints=[];for(var s=0;s<r;s++)ATON.Utils.setVectorPrecision(e.convexPoints[s],4),i.userData._convexPoints.push(e.convexPoints[s].x),i.userData._convexPoints.push(e.convexPoints[s].y),i.userData._convexPoints.push(e.convexPoints[s].z);e.currConvexMesh=i,e.bConvexBuilding=!0}return!0},stopCurrentConvex:function(){e.convexPoints=[],e.bConvexBuilding=!1,e.currSemNode.removeChildren(),ATON.SUI.gPoints.removeChildren()},getCurrentConvexShape:function(){return e.currSemNode},completeConvexShape:function(t){if(e.convexPoints=[],e.bConvexBuilding=!1,void 0!==e.currSemNode){void 0===t&&(t="sem"+e._numShapes);var r=ATON.getSemanticNode(t)||ATON.createSemanticNode(t);return r.add(e.currSemNode.children[0]),r.setMaterial(e.currMaterial),r.setDefaultAndHighlightMaterials(e.currMaterial,ATON.MatHub.materials.semanticShapeHL),r.enablePicking(),e.currSemNode.removeChildren(),e._numShapes++,ATON.SUI.gPoints.removeChildren(),r}},createConvexShape:function(t,r){var n=new THREE.ConvexBufferGeometry(r),a=new THREE.Mesh(n,e.currMaterial);a.userData._convexPoints=[];for(var i=0;i<r.length;i++){var o=r[i];ATON.Utils.setVectorPrecision(o,4),a.userData._convexPoints.push(o.x),a.userData._convexPoints.push(o.y),a.userData._convexPoints.push(o.z)}var s=ATON.getOrCreateSemanticNode(t);return s.add(a),s.setDefaultAndHighlightMaterials(e.currMaterial,ATON.MatHub.materials.semanticShapeHL),s.enablePicking(),s},addSurfaceConvexPoint:function(t){if(!ATON._queryDataScene)return!1;void 0===t&&(t=.02);var r=ATON._queryDataScene.p,n=ATON._queryDataScene.n;return r.x+=n.x*t,r.y+=n.y*t,r.z+=n.z*t,e.addConvexPoint(r),r},createSphere:function(t,r,n){if(void 0!==r&&void 0!==n){void 0===t&&(t="sem"+e._numShapes);var a=ATON.getOrCreateSemanticNode(t),i=new THREE.Mesh(ATON.Utils.geomUnitSphere,e.currMaterial),o=new THREE.Object3D;return o.position.copy(r),o.scale.set(n,n,n),o.add(i),a.add(o),a.enablePicking(),a.setDefaultAndHighlightMaterials(e.currMaterial,ATON.MatHub.materials.semanticShapeHL),e._numShapes++,a}},createSurfaceSphere:function(t){if(ATON._queryDataScene){var r=ATON._queryDataScene.p,n=ATON.SUI.getSelectorRadius();return e.createSphere(t,r,n)}}},t=e;exports.default=t;
},{}],"Z6YW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var o={realize:function(){o.PATH_RES_ICONS=ATON.PATH_RES+"icons/",o._bPopup=!1,o.bPopupBlurBG=!1,o.urlParams=new URLSearchParams(window.location.search),o._uiSetupBase(),ATON.realize()},addBasicLoaderEvents:function(){ATON.on("NodeRequestFired",function(){$("#idLoader").show()}),ATON.on("AllNodeRequestsCompleted",function(){$("#idLoader").hide(),void 0===ATON.Nav.homePOV&&ATON.Nav.computeAndRequestDefaultHome(.5)})},loadSceneID:function(o){if(void 0!==o){var e=ATON.PATH_RESTAPI_SCENE+o;ATON.SceneHub._bEdit&&(e+=",edit"),ATON.SceneHub.load(e,o),console.log(e)}},uiBasicSetup:function(){o.uiAddButton("idTopToolbar","fullscreen",ATON.toggleFullScreen),ATON.Utils.isConnectionSecure()&&o.uiAddButton("idTopToolbar","vr",ATON.XR.toggle),o.uiAddButton("idBottomToolbar","home",function(){ATON.Nav.requestHome(.1)})},_uiSetupBase:function(){$("#idPopup").click(o.popupClose),$("#idLoader").html("<img src='"+ATON.PATH_RES+"loader.png'>")},uiAddButton:function(e,t,n){var i="<button id='btn-"+t+"' type='button' class='atonBTN'><img src='"+o.PATH_RES_ICONS+t+".png'></button>";$("#"+e).append(i),n&&$("#btn-"+t).click(n)},uiAddButtonHome:function(e){o.uiAddButton(e,"home",function(){ATON.Nav.requestHome(.1)})},uiAddButtonFirstPerson:function(e){o.uiAddButton(e,"fp",ATON.Nav.setFirstPersonControl)},uiAddButtonVR:function(e){ATON.Utils.isConnectionSecure()&&o.uiAddButton(e,"vr",ATON.XR.toggle)},uiAddButtonDeviceOrientation:function(e){ATON.Utils.isConnectionSecure()&&ATON.Utils.isMobile()&&o.uiAddButton(e,"devori",ATON.Nav.setDeviceOrientationControl)},uiAddButtonQR:function(e){o.uiAddButton(e,"qr",o.popupQR)},uiAttachInputFilterID:function(o){$("#"+o).on("keyup change input",function(){var e=$("#"+o).val(),t=new RegExp("[^A-Za-z-_]","ig");$("#"+o).val(e.replace(t,""))})},setupBasicUISounds:function(){o.auLib={},o.auLib.switch=new Audio(ATON.PATH_RES+"audio/switch.wav"),o.auLib.switch.loop=!1},popupShow:function(e){return!o._bPopup&&($("#idPopup").html("<div class='atonPopup' id='idPopupContent'>"+e+"</div>"),$("#idPopupContent").click(function(o){o.stopPropagation()}),$("#idPopup").fadeIn(),o._bPopup=!0,o.bPopupBlurBG&&(ATON._renderer.setPixelRatio(.1),ATON._renderer.render(ATON._mainRoot,ATON.Nav._camera)),ATON._bPauseQuery=!0,ATON.renderPause(),!0)},popupClose:function(){o._bPopup=!1,ATON.renderResume(),o.bPopupBlurBG&&ATON.resetPixelDensity(),$("#idPopup").fadeOut(),ATON._bPauseQuery=!1,ATON.focusOn3DView()},popupQR:function(){if("<div class='atonQRcontainer' id='idQRcode'></div><br><br>",ATON.FE.popupShow("<h1>Share</h1><div class='atonQRcontainer' id='idQRcode'></div><br><br>")){var o=window.location.href;new QRCode(document.getElementById("idQRcode"),o)}}},e=o;exports.default=e;
},{}],"yaoK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=v(require("./ATON.node.js")),o=v(require("./ATON.pov.js")),n=v(require("./ATON.lightprobe.js")),t=v(require("./ATON.eventhub.js")),r=v(require("./ATON.mathub.js")),a=v(require("./ATON.utils.js")),i=v(require("./ATON.scenehub.js")),d=v(require("./ATON.nav.js")),s=v(require("./ATON.xr.js")),c=v(require("./ATON.sui.js")),_=v(require("./ATON.vroadcast.js")),u=v(require("./ATON.semfactory.js")),l=v(require("./ATON.fe.js"));function v(e){return e&&e.__esModule?e:{default:e}}var S={};window.ATON=S,S.Node=e.default,S.POV=o.default,S.LightProbe=n.default,S.EventHub=t.default,S.Utils=a.default,S.SceneHub=i.default,S.MatHub=r.default,S.Nav=d.default,S.XR=s.default,S.SUI=c.default,S.VRoadcast=_.default,S.SemFactory=u.default,S.FE=l.default,S.STD_UPVECTOR=new THREE.Vector3(0,1,0),S.ROOT_NID=".",S.RAD2DEG=180/Math.PI,S.DEG2RAD=Math.PI/180,S.NTYPES={},S.NTYPES.SCENE=3,S.NTYPES.SEM=4,S.NTYPES.UI=5,S.PATH_RESTAPI=window.location.origin+"/api/",S.PATH_RESTAPI_SCENE=S.PATH_RESTAPI+"scene/",S.PATH_MODS=window.location.origin+"/mods/",S.PATH_THREE=S.PATH_MODS+"three/",S.PATH_DRACO_LIB=S.PATH_THREE+"examples/js/libs/draco/",S.PATH_BASIS_LIB=S.PATH_THREE+"examples/js/libs/basis/",S.PATH_COLLECTION=window.location.origin+"/collection/",S.PATH_MODELS=S.PATH_COLLECTION+"models/",S.PATH_SCENES=window.location.origin+"/scenes/",S.PATH_RES=window.location.origin+"/res/",S.setPathCollection=function(e){S.PATH_COLLECTION=window.location.origin+e,S.PATH_MODELS=S.PATH_COLLECTION+"models/"},S.setPathScenes=function(e){S.PATH_SCENES=window.location.origin+e},S._setupBaseListeners=function(){var e=S._renderer.domElement;window.addEventListener("resize",S._onResize,!1),e.addEventListener("mousemove",S._updateScreenMove,!1),e.addEventListener("wheel",S._onMouseWheel,!1),Hammer(e).on("doubletap",function(e){S.fireEvent("DoubleTap",e.srcEvent)}),Hammer(e).on("tap",function(e){if(S._updateScreenMove(e.srcEvent),S._handleQueries(),S.fireEvent("Tap",e.srcEvent),void 0!==S._hoveredUI){var o=S.getUINode(S._hoveredUI);o&&o.onSelect&&o.onSelect()}}),S.on("DoubleTap",function(e){S.defaultDoubleTapFromScreenCoords(e)}),S._kModShift=!1,S._kModCtrl=!1,e.addEventListener("keydown",function(e){"Shift"===e.key&&(S._kModShift=!0),"Control"===e.key&&(S._kModCtrl=!0),S.fireEvent("KeyPress",e.key)},!1),e.addEventListener("keyup",function(e){"Shift"===e.key&&(S._kModShift=!1),"Control"===e.key&&(S._kModCtrl=!1),S.fireEvent("KeyUp",e.key)},!1),S.on("KeyPress",function(e){if("+"===e){var o=S.Nav.getFOV()+1;S.Nav.setFOV(o)}if("-"===e){var n=S.Nav.getFOV()-1;S.Nav.setFOV(n)}if("PageUp"===e){var t=S.SUI.mainSelector.scale.x+.02;S.SUI.setSelectorRadius(t)}if("PageDown"===e){var r=S.SUI.mainSelector.scale.x-.02;r=Math.max(r,.01),S.SUI.setSelectorRadius(r)}}),S.on("SemanticNodeLeave",function(e){var o=S.getSemanticNode(e);o&&o.restoreDefaultMaterial()}),S.on("SemanticNodeHover",function(e){var o=S.getSemanticNode(e);o&&o.highlight()})},S._onResize=function(){S.Nav._camera.aspect=window.innerWidth/window.innerHeight,S.Nav._camera.updateProjectionMatrix(),S._renderer.setSize(window.innerWidth,window.innerHeight),console.log("onResize")},S._onMouseWheel=function(e){e.preventDefault(),S.fireEvent("MouseWheel",e.deltaY)},S.focusOn3DView=function(){S._renderer.domElement.focus()},S.defaultDoubleTapFromScreenCoords=function(e){S._updateScreenMove(e),S._handleQueryScene();var o=S.Nav.isFirstPerson()||S.Nav.isDevOri();if(S._queryDataScene&&o){var n=S._queryDataScene.p;if(S._queryDataScene.n.y>.7){var t=S.Nav._vDir,r=new THREE.Vector3(n.x,n.y+S.userHeight,n.z),a=new THREE.Vector3(r.x+t.x,r.y+t.y,r.z+t.z),i=(new S.POV).setPosition(r).setTarget(a);S.Nav.requestPOV(i,.5)}}else{var d=S.getSemanticNode(S._hoveredSemNode);S._queryDataSem&&d?S.Nav.requestPOVbyNode(d,.3):S._queryDataScene&&S.Nav.requestRetarget(S._queryDataScene.p,void 0,.3)}},S.toggleFullScreen=function(e){void 0!==e?e&&screenfull.request():screenfull.toggle()},S.realize=function(){console.log("realize"),S.Utils.init(),S.Utils.profileDevice(),S._clock=new THREE.Clock(!0);S._renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),S._renderer.setSize(window.innerWidth,window.innerHeight),S._stdpxd=1,S._renderer.setPixelRatio(S._stdpxd),S._renderer.outputEncoding=THREE.sRGBEncoding,S._renderer.setAnimationLoop(S._onFrame),S._maxAnisotropy=4,console.log(S._renderer.capabilities),THREE.Cache.enabled=!0,S.userHeight=1.6,document.body.appendChild(S._renderer.domElement),S.EventHub.init(),S.MatHub.init(),S._assetsManager={},S._aLoader=new THREE.GLTFLoader,S._dracoLoader=new THREE.DRACOLoader,S._dracoLoader.setDecoderPath(S.PATH_DRACO_LIB),S._aLoader.setDRACOLoader(S._dracoLoader),S._numReqLoad=0,S._lps=[],S.initGraphs(),S.SceneHub.init(),S.Nav.init(),S.XR.init(),S.SUI.init(),S.VRoadcast.init(),S.SemFactory.init(),S._queryDataScene=void 0,S._queryDataSem=void 0,S._queryDataUI=void 0,S._hoveredSemNode=void 0,S._hoveredUI=void 0,S._bQuerySemOcclusion=!0,S._bQueryNormals=!0,S._bPauseQuery=!1,S._screenPointerCoords=new THREE.Vector2(0,0),S._rcScene=new THREE.Raycaster,S._rcScene.layers.set(S.NTYPES.SCENE),S._rcSemantics=new THREE.Raycaster,S._rcSemantics.layers.set(S.NTYPES.SEM),S._rcUI=new THREE.Raycaster,S._rcUI.layers.set(S.NTYPES.UI),S._registerRCS(),S._setupBaseListeners(),S.focusOn3DView()},S.renderPause=function(){S._renderer.setAnimationLoop(void 0)},S.renderResume=function(){S._renderer.setAnimationLoop(S._onFrame)},S._setupLoadManager=function(){S._loadManager=new THREE.LoadingManager,S._loadManager.onStart=function(e,o,n){console.log("Started loading file: "+e+".\nLoaded "+o+" of "+n+" files."),S.fireEvent("NodeRequestFired",e)},S._loadManager.onLoad=function(){console.log("Loading complete!"),S.fireEvent("AllNodeRequestsCompleted")},S._loadManager.onProgress=function(e,o,n){},S._loadManager.onError=function(e){console.log("There was an error loading "+e)}},S.setDefaultPixelDensity=function(e){S._stdpxd=e,S._renderer.setPixelRatio(e)},S.resetPixelDensity=function(){S._renderer.setPixelRatio(S._stdpxd)},S.snodes={},S.semnodes={},S.uinodes={},S.createSceneNode=function(e){return new S.Node(e,S.NTYPES.SCENE)},S.getSceneNode=function(e){if(void 0!==e)return S.snodes[e]},S.getOrCreateSceneNode=function(e){var o=S.getSceneNode(e);return void 0!==o?o:S.createSceneNode(e)},S.getRootScene=function(){return S._rootVisible},S.createSemanticNode=function(e){return new S.Node(e,S.NTYPES.SEM)},S.getSemanticNode=function(e){if(void 0!==e)return S.semnodes[e]},S.getOrCreateSemanticNode=function(e){var o=S.getSemanticNode(e);return void 0!==o?o:S.createSemanticNode(e)},S.getRootSemantics=function(){return S._rootSem},S.createUINode=function(e){return new S.Node(e,S.NTYPES.UI)},S.getUINode=function(e){if(void 0!==e)return S.uinodes[e]},S.getRootUI=function(){return S._rootUI},S._assetReqNew=function(e){S._numReqLoad++,S.fireEvent("NodeRequestFired",e)},S._assetReqComplete=function(e){S.fireEvent("NodeRequestCompleted",e),S._numReqLoad--,S._numReqLoad<=0&&(S.fireEvent("AllNodeRequestsCompleted"),setTimeout(function(){var e=S._rootVisible.getBound().center;e&&S._mMainPano.position.set(e.x,e.y,e.z),S.updateLightProbes(),console.log("LPs updated.")},1e3))},S.initGraphs=function(){S._mainRoot=new THREE.Scene,S._mainRoot.background=new THREE.Color(.7,.7,.7),S._rootVisibleGlobal=new THREE.Group,S._mainRoot.add(S._rootVisibleGlobal),S._rootVisible=S.createSceneNode().setAsRoot(),S._rootVisibleGlobal.add(S._rootVisible),S._rootSem=S.createSemanticNode().setAsRoot(),S._mainRoot.add(S._rootSem),S._rootUI=S.createUINode().setAsRoot(),S._mainRoot.add(S._rootUI),S.ambLight=new THREE.AmbientLight(new THREE.Color(1,1,1)),S._rootVisibleGlobal.add(S.ambLight)},S.setBackgroundColor=function(e){S._mainRoot.background=e},S.addLightProbe=function(e){S._lps.push(e)},S.updateLightProbes=function(){for(var e in S._lps)S._lps[e].update();S._lps[0]&&(S._indLP&&S._mainRoot.remove(S._indLP),S._indLP=THREE.LightProbeGenerator.fromCubeRenderTarget(S._renderer,S._lps[0]._prevCCtarget),S._mainRoot.add(S._indLP)),S._rootVisible.traverse(function(e){void 0!==e.userData.LP&&(e.material.envMap=e.userData.LP.getEnvTex())})},S.setMainPanorama=function(e){var o=(new THREE.TextureLoader).load(e);o.encoding=THREE.sRGBEncoding,void 0===S._matMainPano?(S._gMainPano=new THREE.SphereBufferGeometry(1,30,30),S.setMainPanoramaRadius(.9*S.Nav.STD_FAR),S._matMainPano=new THREE.MeshBasicMaterial({map:o,fog:!1,depthTest:!1,depthWrite:!1}),S._mMainPano=new THREE.Mesh(S._gMainPano,S._matMainPano),S._mMainPano.frustumCulled=!1,S._mMainPano.onAfterRender=function(){S._mMainPano.position.copy(S.Nav._currPOV.pos)},S._rootVisibleGlobal.add(S._mMainPano)):S._matMainPano.map=o},S.setMainPanoramaRadius=function(e){void 0!==S._gMainPano&&S._gMainPano.scale(-e,e,e)},S._onFrame=function(){var e=S._clock.getDelta();S._fps=1/e,S._dt=e,S.Nav._bControlChange=!1,S.Nav._controls.update(e),S._renderer.render(S._mainRoot,S.Nav._camera),S.XR.isPresenting()&&S.XR.update(),S._bPauseQuery||S._handleQueries(),S.Nav.update(),S.VRoadcast.update(),S.SUI.update(),S.fireEvent("frame")},S._updateScreenMove=function(e){if(e.preventDefault(),S.Nav._mode===S.Nav.MODE_DEVORI)return S._screenPointerCoords.x=0,void(S._screenPointerCoords.y=0);S._screenPointerCoords.x=e.clientX/window.innerWidth*2-1,S._screenPointerCoords.y=-e.clientY/window.innerHeight*2+1},S._registerRCS=function(){S._rcRR=0,S._rcHandlers=[],S._rcHandlers.push(S._handleQueryScene),S._rcHandlers.push(S._handleQuerySemantics),S._rcHandlers.push(S._handleQueryUI)},S._handleQueries=function(){S.Nav.isTransitioning()||(S._handleQueryScene(),S._handleQuerySemantics(),S._handleQueryUI())},S._handleQueryScene=function(){if(S.XR.isPresenting()?S._rcScene.set(S.XR.getControllerWorldLocation(0),S.XR.getControllerWorldDirection(0)):S._rcScene.setFromCamera(S._screenPointerCoords,S.Nav._camera),S._hitsScene=[],S._rcScene.intersectObjects(S._mainRoot.children,!0,S._hitsScene),S._hitsScene.length<=0)S._queryDataScene=void 0;else{var e=S._hitsScene[0];S._queryDataScene={},S._queryDataScene.p=e.point,S._queryDataScene.d=e.distance,S._queryDataScene.o=e.object,S._bQueryNormals&&null!==e.face&&void 0!==e.face.normal&&(S._queryDataScene.matrixWorld=(new THREE.Matrix3).getNormalMatrix(e.object.matrixWorld),S._queryDataScene.n=e.face.normal.clone().applyMatrix3(S._queryDataScene.matrixWorld).normalize())}},S.getSceneQueriedPoint=function(){if(void 0!==S._queryDataScene)return S._queryDataScene.p},S.getSceneQueriedDistance=function(){if(void 0!==S._queryDataScene)return S._queryDataScene.d},S.getSceneQueriedNormal=function(){if(void 0!==S._queryDataScene)return S._queryDataScene.n},S._handleQuerySemantics=function(){if(S.XR.isPresenting()?S._rcSemantics.set(S.XR.getControllerWorldLocation(0),S.XR.getControllerWorldDirection(0)):S._rcSemantics.setFromCamera(S._screenPointerCoords,S.Nav._camera),S._hitsSem=[],S._rcSemantics.intersectObjects(S._mainRoot.children,!0,S._hitsSem),S._hitsSem.length<=0){if(S._queryDataSem=void 0,S._hoveredSemNode){S.fireEvent("SemanticNodeLeave",S._hoveredSemNode);var e=S.getSemanticNode(S._hoveredSemNode);e&&e.onLeave&&e.onLeave()}S._hoveredSemNode=void 0}else{var o=S._hitsSem[0];if(S._bQuerySemOcclusion&&S._queryDataScene&&S._queryDataScene.d<o.distance){if(S._queryDataSem=void 0,S._hoveredSemNode){S.fireEvent("SemanticNodeLeave",S._hoveredSemNode);var n=S.getSemanticNode(S._hoveredSemNode);n&&n.onLeave&&n.onLeave()}S._hoveredSemNode=void 0}else{S._queryDataSem={},S._queryDataSem.p=o.point,S._queryDataSem.d=o.distance,S._queryDataSem.o=o.object,S._queryDataSem.list=[];for(var t=S._queryDataSem.list,r=o.object.parent;r;)r.nid&&r.nid!==S.ROOT_NID&&t.push(r.nid),r=r.parent;var a=t[0];if(a&&S._hoveredSemNode!==a){if(S._hoveredSemNode){S.fireEvent("SemanticNodeLeave",S._hoveredSemNode);var i=S.getSemanticNode(S._hoveredSemNode);i&&i.onLeave&&i.onLeave()}S._hoveredSemNode=a,S.fireEvent("SemanticNodeHover",a);var d=S.getSemanticNode(a);d&&d.onHover&&d.onHover()}}}},S._handleQueryUI=function(){if(S.XR.isPresenting()?S._rcUI.set(S.XR.getControllerWorldLocation(0),S.XR.getControllerWorldDirection(0)):S._rcUI.setFromCamera(S._screenPointerCoords,S.Nav._camera),S._hitsUI=[],S._rcUI.intersectObjects(S._mainRoot.children,!0,S._hitsUI),S._hitsUI.length<=0){if(S._queryDataUI=void 0,S._hoveredUI){S.fireEvent("UINodeLeave",S._hoveredUI);var e=S.getUINode(S._hoveredUI);e&&e.onLeave&&e.onLeave()}S._hoveredUI=void 0}else{var o=S._hitsUI[0];if(S._queryDataScene&&S._queryDataScene.d<o.distance){if(S._queryDataUI=void 0,S._hoveredUI){S.fireEvent("SemanticNodeLeave",S._hoveredUI);var n=S.getUINode(S._hoveredUI);n&&n.onLeave&&n.onLeave()}S._hoveredUI=void 0}else{S._queryDataUI={},S._queryDataUI.p=o.point,S._queryDataUI.d=o.distance,S._queryDataUI.o=o.object,S._queryDataUI.list=[];for(var t=S._queryDataUI.list,r=o.object.parent;r;)r.nid&&r.nid!==S.ROOT_NID&&t.push(r.nid),r=r.parent;var a=t[0];if(a&&S._hoveredUI!==a){if(S._hoveredUI){S.fireEvent("UINodeLeave",S._hoveredUI);var i=S.getUINode(S._hoveredUI);i&&i.onLeave&&i.onLeave()}S._hoveredUI=a,S.fireEvent("UINodeHover",a);var d=S.getUINode(a);d&&d.onHover&&d.onHover()}}}};var m=S;exports.default=m;
},{"./ATON.node.js":"XTSP","./ATON.pov.js":"CwXu","./ATON.lightprobe.js":"MNcy","./ATON.eventhub.js":"LryX","./ATON.mathub.js":"R8yv","./ATON.utils.js":"P9TA","./ATON.scenehub.js":"qC8Z","./ATON.nav.js":"nomA","./ATON.xr.js":"jROx","./ATON.sui.js":"xSlA","./ATON.vroadcast.js":"mY3J","./ATON.semfactory.js":"dQQK","./ATON.fe.js":"Z6YW"}]},{},["yaoK"], null)
//# sourceMappingURL=/ATON.min.js.map